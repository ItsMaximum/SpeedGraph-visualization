id: flourish/horserace
name: Horserace chart
author: Flourish & Google News Lab teams
description: A simple “horserace” chart template for showing changing rank over time

sdk_version: 2

build:
  src:
    script: npm run build
    directory: src
    files:
      - rollup.config.js
  less:
    script: npm run less
    directory: less

settings:
  - Scoring type
  - property: higher_scores_win
    name: Higher scores win
    description: Uncheck this if lower scores beat higher scores (eg. race times)
    type: boolean

  - Line styles
  - property: line_width
    name: Line width
    type: number
  - property: line_opacity
    name: Line opacity
    type: number
  - property: shade
    name: Show shading behind line
    type: boolean
  - property: shade_width
    name: Shading width
    type: number
  - property: shade_opacity
    name: Shading opacity
    type: number
  - property: curve
    name: Curve
    type: string
    choices:
      -
        - Straight
        - curveLinear
      -
        - Normal curve
        - curveMonotoneX
      -
        - Overflowing curve
        - curveNatural
      -
        - Step middle
        - curveStep
      -
        - Step after
        - curveStepAfter
      -
        - Step before
        - curveStepBefore
  - Circles and labels
  - property: start_circle_r
    name: Start circle radius
    type: number
    min: 0
  - property: end_circle_r
    name: End circle radius
    type: number
    min: 0
  - property: rank_font_size
    name: Rank font size
    type: number
  - property: label_font_size
    name: Label font size
    type: number
  - property: label_decimals
    name: Max number of decimal places on scores
    type: number
  - property: horse_images
    name: Use image
    type: boolean

  - Colors
  - property: bg_color
    name: Background color
    type: color
  - property: palette
    name: Color scheme
    description: Choose "Other" to specify a comma-separate list of colour names or codes, or the name of a d3-chromatic scheme such as schemeAccent
    type: string
    choices:
      -
        - Category 10
        - schemeCategory10
      -
        - Category 20
        - schemeCategory20
      -
        - Category 20b
        - schemeCategory20b
      -
        - Category 20c
        - schemeCategory20c
      -
        - Accent
        - schemeAccent
      -
        - Dark 2
        - schemeDark2
      -
        - Paired
        - schemePaired
      -
        - Pastel 1
        - schemePastel1
      -
        - Pastel 2
        - schemePastel2
    choices_other: yes
  - property: custom_colors
    name: Custom colors
    description: Override the colour scheme by entering a comma-separated list of colors names or codes
    type: string
  - Animation
  - property: stage_duration
    name: Animation duration
    description: The "race" animation length in milliseconds per stage
    type: number
    min: 0
    step: 100
  - property: update_duration
    name: Mode duration
    description: The animation duration when change between ranks and scores modes
    type: number
    min: 0
    step: 100

  - Margins
  - property: margin_top
    name: Top
    type: number
    min: 0
    step: 10
  - property: margin_right
    name: Right
    type: number
    min: 0
    step: 10
  - property: margin_bottom
    name: Bottom
    type: number
    min: 0
    step: 10
  - property: margin_left
    name: Left
    type: number
    min: 0
    step: 10

  - Default view
  - property: ranks_view
    name: Show ranks by default
    type: boolean
  - property: target_position
    name: Target stage
    description: Which stage the graphic should "play" to by default
    type: number
    min: 1

data:
  - Data
  - name: Name column
    dataset: horserace
    key: name
    type: column
    column: "Data::A"
  - name: Picture column
    dataset: horserace
    key: pic
    type: column
    column: "Data::B"
  - name: Times
    dataset: horserace
    key: stages
    type: columns
    columns: "Data::C-K"
